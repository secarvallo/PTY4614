# ğŸ”„ Diagrama de Flujo - Registro de Usuario

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ‘¤ USUARIO (Browser)                                â”‚
â”‚                       http://localhost:4200/auth/register                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Llena formulario
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“± FRONTEND - register.page.ts                                              â”‚
â”‚                                                                               â”‚
â”‚  FormGroup:                                                                   â”‚
â”‚    â€¢ nombre: 'Juan' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º firstName: 'Juan'                  â”‚
â”‚    â€¢ apellido: 'PÃ©rez' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º lastName: 'PÃ©rez'                  â”‚
â”‚    â€¢ email: 'juan@example.com' â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º email: 'juan@example.com'          â”‚
â”‚    â€¢ telefono: '+56912345678' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º phone: '+56912345678'              â”‚
â”‚    â€¢ password: '********' â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º password: '********'                â”‚
â”‚    â€¢ acceptTerms: â˜‘ï¸  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º acceptTerms: true                 â”‚
â”‚    â€¢ acceptPrivacy: â˜‘ï¸  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º acceptPrivacy: true               â”‚
â”‚    â€¢ acceptMarketing: â˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º acceptMarketing: false            â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“ Log Cliente: Formulario validado                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ HTTP POST
                                   â”‚ Content-Type: application/json
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ HTTP REQUEST                                                              â”‚
â”‚  POST http://localhost:3003/api/auth/register                                â”‚
â”‚                                                                               â”‚
â”‚  Body: {                                                                      â”‚
â”‚    "email": "juan@example.com",                                              â”‚
â”‚    "password": "MiPassword123!",                                             â”‚
â”‚    "firstName": "Juan",                                                      â”‚
â”‚    "lastName": "PÃ©rez",                                                      â”‚
â”‚    "phone": "+56912345678",                                                  â”‚
â”‚    "acceptTerms": true,          â—„â”€â”€â”€ OBLIGATORIO                            â”‚
â”‚    "acceptPrivacy": true,        â—„â”€â”€â”€ OBLIGATORIO                            â”‚
â”‚    "acceptMarketing": false      â—„â”€â”€â”€ OPCIONAL                               â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Express Router
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ® BACKEND - auth.controller.v2.ts                                          â”‚
â”‚                                                                               â”‚
â”‚  async register(req, res) {                                                  â”‚
â”‚    ğŸ“ Log #1: Registration attempt                                           â”‚
â”‚       - Email: juan@example.com                                              â”‚
â”‚       - IP: 192.168.1.100                                                    â”‚
â”‚       - User-Agent: Mozilla/5.0...                                           â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“ Log #2: Acceptance fields received                                     â”‚
â”‚       - acceptTerms: true                                                    â”‚
â”‚       - acceptPrivacy: true                                                  â”‚
â”‚       - acceptMarketing: false                                               â”‚
â”‚                                                                               â”‚
â”‚    âœ… Validation: All fields present                                         â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Calls service
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” BACKEND - authentication.service.ts                                      â”‚
â”‚                                                                               â”‚
â”‚  async registerUser(request) {                                               â”‚
â”‚                                                                               â”‚
â”‚    ğŸ” STEP 1: Validate Required Fields                                       â”‚
â”‚       âœ“ Email format valid                                                   â”‚
â”‚       âœ“ Password >= 8 chars                                                  â”‚
â”‚       âœ“ firstName not empty                                                  â”‚
â”‚       âœ“ acceptTerms === true â—„â”€â”€â”€ Si false, ERROR                           â”‚
â”‚       âœ“ acceptPrivacy === true â—„â”€â”€â”€ Si false, ERROR                         â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“ Log #3: Validation passed                                              â”‚
â”‚                                                                               â”‚
â”‚    ğŸ”’ STEP 2: Hash Password                                                  â”‚
â”‚       password_hash = bcrypt.hash('MiPassword123!', 10)                      â”‚
â”‚       = '$2b$10$...'                                                          â”‚
â”‚                                                                               â”‚
â”‚    ğŸ”„ STEP 3: Normalize Data                                                 â”‚
â”‚       email = email.toLowerCase().trim()                                     â”‚
â”‚       nombre = firstName.trim()                                              â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“ Log #4: Creating user record                                           â”‚
â”‚       - User: juan@example.com                                               â”‚
â”‚       - Acceptance: {terms: true, privacy: true, marketing: false}           â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“¦ userData = {                                                            â”‚
â”‚         email: 'juan@example.com',                                           â”‚
â”‚         password_hash: '$2b$10$...',                                          â”‚
â”‚         nombre: 'Juan',                                                      â”‚
â”‚         apellido: 'PÃ©rez',                                                   â”‚
â”‚         phone: '+56912345678',                                               â”‚
â”‚         email_verified: false,                                               â”‚
â”‚         is_active: true,                                                     â”‚
â”‚         created_at: '2025-10-13T...',                                        â”‚
â”‚         accept_terms: true,      â—„â”€â”€â”€ Campo crÃ­tico                         â”‚
â”‚         accept_privacy: true,    â—„â”€â”€â”€ Campo crÃ­tico                         â”‚
â”‚         marketing_consent: false                                             â”‚
â”‚       }                                                                       â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Calls repository
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¾ BACKEND - user.repository.ts                                             â”‚
â”‚                                                                               â”‚
â”‚  async create(user) {                                                        â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“Š SQL Query:                                                              â”‚
â”‚       INSERT INTO users (                                                    â”‚
â”‚         email, password_hash, nombre, apellido, phone,                       â”‚
â”‚         email_verified, two_fa_enabled, is_active,                           â”‚
â”‚         created_at, updated_at,                                              â”‚
â”‚         accept_terms, accept_privacy, marketing_consent                      â”‚
â”‚       )                                                                       â”‚
â”‚       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)       â”‚
â”‚       RETURNING *                                                            â”‚
â”‚                                                                               â”‚
â”‚    ğŸ“ Log #5: User created successfully                                      â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Executes query
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—„ï¸ POSTGRESQL DATABASE - lunglife_db                                        â”‚
â”‚                                                                               â”‚
â”‚  Table: users                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ id â”‚ email             â”‚ nombre   â”‚ apellido â”‚ accept_terms â”‚ ...     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 1  â”‚ juan@example.com  â”‚ Juan     â”‚ PÃ©rez    â”‚ true         â”‚ ...     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                               â”‚
â”‚  Constraints Applied:                                                        â”‚
â”‚    âœ“ UNIQUE(email) - No duplicados                                          â”‚
â”‚    âœ“ NOT NULL(accept_terms) - Obligatorio                                   â”‚
â”‚    âœ“ NOT NULL(accept_privacy) - Obligatorio                                 â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“ PostgreSQL Log: INSERT successful (1 row)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Returns inserted row
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” BACKEND - authentication.service.ts                                      â”‚
â”‚                                                                               â”‚
â”‚  âœ… User inserted successfully                                               â”‚
â”‚                                                                               â”‚
â”‚  ğŸ”‘ STEP 4: Generate JWT Tokens                                              â”‚
â”‚     accessToken = jwt.sign({userId: 1, email: 'juan@example.com'}, ...)     â”‚
â”‚     refreshToken = jwt.sign({userId: 1}, ...)                                â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“ Log #6: Registration completed                                           â”‚
â”‚     - UserId: 1                                                              â”‚
â”‚     - Duration: 245ms                                                        â”‚
â”‚     - Acceptance: {terms: true, privacy: true, marketing: false}             â”‚
â”‚                                                                               â”‚
â”‚  return {                                                                    â”‚
â”‚    success: true,                                                            â”‚
â”‚    user: { id: 1, email: 'juan@example.com', ... },                         â”‚
â”‚    token: 'eyJhbGciOiJIUzI1NiIs...',                                         â”‚
â”‚    refreshToken: 'eyJhbGciOiJIUzI1NiIs...'                                   â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Returns to controller
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ® BACKEND - auth.controller.v2.ts                                          â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“ Log #7: Registration successful                                          â”‚
â”‚     - Email: juan@example.com                                                â”‚
â”‚     - Duration: 250ms                                                        â”‚
â”‚                                                                               â”‚
â”‚  res.status(201).json({                                                      â”‚
â”‚    success: true,                                                            â”‚
â”‚    message: 'User registered successfully',                                  â”‚
â”‚    user: {                                                                   â”‚
â”‚      id: 1,                                                                  â”‚
â”‚      email: 'juan@example.com',                                              â”‚
â”‚      firstName: 'Juan',                                                      â”‚
â”‚      lastName: 'PÃ©rez',                                                      â”‚
â”‚      acceptanceStatus: {     â—„â”€â”€â”€ IMPORTANTE: Se devuelve al frontend      â”‚
â”‚        terms: true,                                                          â”‚
â”‚        privacy: true,                                                        â”‚
â”‚        marketing: false                                                      â”‚
â”‚      }                                                                        â”‚
â”‚    },                                                                         â”‚
â”‚    token: 'eyJhbGciOiJIUzI1NiIs...'                                          â”‚
â”‚  })                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ HTTP 201 Created
                                   â”‚ Content-Type: application/json
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“± FRONTEND - register.page.ts                                              â”‚
â”‚                                                                               â”‚
â”‚  âœ… Registration successful!                                                 â”‚
â”‚                                                                               â”‚
â”‚  Actions:                                                                    â”‚
â”‚    1. Hide loading spinner                                                   â”‚
â”‚    2. Show success toast: "Account created successfully!"                    â”‚
â”‚    3. Navigate to /auth/login with email pre-filled                          â”‚
â”‚                                                                               â”‚
â”‚  ğŸ“ Frontend Log: User registered, redirecting to login                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Router navigation
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ğŸ‰ REGISTRO COMPLETADO                                  â”‚
â”‚                                                                               â”‚
â”‚  Usuario ve:                                                                 â”‚
â”‚    âœ… Toast: "Account created successfully!"                                 â”‚
â”‚    ğŸ“§ PÃ¡gina de login con email: juan@example.com                            â”‚
â”‚                                                                               â”‚
â”‚  Base de datos contiene:                                                     â”‚
â”‚    âœ… Registro con ID: 1                                                     â”‚
â”‚    âœ… Email: juan@example.com                                                â”‚
â”‚    âœ… Nombre: Juan PÃ©rez                                                     â”‚
â”‚    âœ… Campos de aceptaciÃ³n: terms=true, privacy=true, marketing=false        â”‚
â”‚    âœ… Password hasheado                                                      â”‚
â”‚    âœ… Timestamps creados                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Puntos de Trazabilidad

| #  | Componente               | AcciÃ³n                     | Log Generado                           |
|----|--------------------------|----------------------------|----------------------------------------|
| 1  | Controller               | Inicio de registro         | Email, IP, User-Agent                  |
| 2  | Controller               | RecepciÃ³n de aceptaciones  | acceptTerms, acceptPrivacy, marketing  |
| 3  | Service                  | ValidaciÃ³n exitosa         | Campos validados                       |
| 4  | Service                  | Pre-inserciÃ³n              | userData con acceptance                |
| 5  | Repository               | Post-inserciÃ³n             | "User created successfully"            |
| 6  | Service                  | Registro completado        | UserId, duraciÃ³n, acceptance           |
| 7  | Controller               | Respuesta enviada          | Email, duraciÃ³n                        |

---

## ğŸ” Campos de AceptaciÃ³n en Cada Capa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAMPO            â”‚ Frontend  â”‚ API      â”‚ Service  â”‚ DB    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TÃ©rminos         â”‚ âœ… â˜‘ï¸      â”‚ âœ… true  â”‚ âœ… true  â”‚ âœ… t  â”‚
â”‚  Privacidad       â”‚ âœ… â˜‘ï¸      â”‚ âœ… true  â”‚ âœ… true  â”‚ âœ… t  â”‚
â”‚  Marketing        â”‚ âŒ â˜      â”‚ âŒ false â”‚ âŒ false â”‚ âŒ f  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Leyenda:
  âœ… = Aceptado/true
  âŒ = No aceptado/false
  â˜‘ï¸  = Checkbox marcado
  â˜ = Checkbox desmarcado
  t = true en PostgreSQL
  f = false en PostgreSQL
```

---

## ğŸ§ª VerificaciÃ³n

### Verificar en Frontend:
1. Abrir http://localhost:4200/auth/register
2. Llenar formulario
3. Marcar tÃ©rminos y privacidad
4. Enviar formulario
5. Ver toast de Ã©xito

### Verificar en Backend:
```bash
# Ver logs en tiempo real
npx ts-node src/index.ts

# Buscar lÃ­neas con:
# - "Registration attempt started"
# - "Acceptance fields received"
# - "User created successfully"
# - "Registration completed"
```

### Verificar en Base de Datos:
```sql
SELECT 
    id,
    email,
    nombre,
    apellido,
    accept_terms,
    accept_privacy,
    marketing_consent,
    created_at
FROM users
WHERE email = 'juan@example.com';
```

---

**DocumentaciÃ³n completa**: Ver `TRACEABILITY_REGISTRATION.md`
