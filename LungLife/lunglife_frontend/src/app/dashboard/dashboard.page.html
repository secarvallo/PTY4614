<ion-content [fullscreen]="true" data-test="dashboard-page">
  <div class="content-wrapper">
    <div class="centered-container-wide">

    @if (user) {
      <div class="welcome-header">
        <h1>Bienvenido de nuevo, {{ user.firstName }}</h1>
        <p>Aquí tienes un resumen de tu progreso. ¡Sigue así!</p>
      </div>

      <div class="dashboard-card">

        <div class="metrics-grid">
          <div class="metric-item smoke-free">
            <ion-icon name="leaf-outline"></ion-icon>
            <span class="value">{{ smokeFreeDays }}</span>
            <span class="label">Días sin fumar</span>
          </div>

          <div class="metric-item money-saved">
            <ion-icon name="cash-outline"></ion-icon>
            <span class="value">{{ moneySaved | currency:'USD':'symbol':'1.0-0' }}</span>
            <span class="label">Dinero Ahorrado</span>
          </div>

          <div class="metric-item cigarettes-avoided">
            <ion-icon name="medical-outline"></ion-icon>
            <span class="value">{{ cigarettesAvoided }}</span>
            <span class="label">Cigarrillos Evitados</span>
          </div>

          <div class="metric-item lung-health">
            <ion-icon name="fitness-outline"></ion-icon>
            <span class="value">{{ lungHealthPercentage }}%</span>
            <span class="label">Salud Pulmonar</span>
          </div>
        </div>
      </div>

      <div class="dashboard-actions">
        <ion-button 
          expand="block" 
          type="button"
          color="primary" 
          shape="round" 
          size="large"
          class="main-action-button"
          (click)="logHabit()"
        >
          <ion-icon name="add-circle-outline" slot="start"></ion-icon>
          Registrar Hábito de Hoy
        </ion-button>
        <ion-button 
          expand="block" 
          type="button"
          fill="outline" 
          shape="round" 
          size="large"
          class="main-action-button"
          (click)="viewProgress()"
        >
          <ion-icon name="bar-chart-outline" slot="start"></ion-icon>
          Ver Progreso Detallado
        </ion-button>
        <ion-button 
          expand="block" 
          type="button"
          fill="outline" 
          shape="round" 
          size="large"
          class="main-action-button"
          routerLink="/profile"
        >
          <ion-icon name="person-outline" slot="start"></ion-icon>
          Gestión de Perfil
        </ion-button>
      </div>
    } @else {
      <div class="loading-state">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Cargando tu dashboard...</p>
      </div>
    }
    </div>
  </div>
</ion-content>